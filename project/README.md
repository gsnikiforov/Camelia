# % help

## Добро пожаловать!

Перед вами Страж. Он призван охранять вас и ваши изречения от нападок гнусных врагов. Поэтому Страж шифрует всё, что вы ему скажете.

Страж умеет шифровать при помощи
* алгоритма Camellia,

а также при помощи методов шифрования
* OFB,
* MGM.

## Возможности Стража

Чтобы вывести подсказку, введите
```bash
python guard.py --help
```
Наиболее полная помощь предлагает именно эта подсказка.

Для шифрования обязательно указать порядок шифрования:
* `e` или `encrypt`
* `d` или `decrypt`

и сообщение. В качестве сообщения можно указать как набор символов, так и название файла. Во втором случае будет зашифровано содержимое файла.
```bash
python guard.py encrypt some_text
```

Для выбора иного метода шифрования стоит передать флаг `--using` (или, кратко, `-u`), как на примере:
```bash
python guard.py --using ofb-camellia decrypt 24368608143
```

При помощи флага `--key` (`-k`) можно передать ключ шифрования. В качестве ключа можно использовать как целые числа, так и слова:
```bash
python guard.py -k key e vadim
```

Результат шифрования можно вывести в файл в формате `json`, используя флаг `--output` (`-o`):
```bash
python guard.py -u mgm-camellia -o path_to_valid_file e vadimka
```

Некоторые методы шифрования требуют дополнительные параметры (так, к примеру, режим OFB требует, помимо прочего, вектор инициализации). Их можно 
указать в формате `json` и передать Стражу при помощи флага `--input` (`-i`; после флага должен стоять путь к файлу):
```bash
python guard.py -u mgm-camellia -i path_to_valid_file d 4904244336957144147765024048237
```

Наконец, опция `--prolix` (`-p`; от англ. *prolix* — многословный) указывает Стражу, чтобы он сообщал важные промежуточные данные в ходе шифрования. Приятная мелочь в ходе отладки...
```bash
python guard.py -p e 123
```

### Пример шифрования

Допустим, мы хотим зашифровать методом `mgm-camellia` содержимое файла `message`:
```plain
Плов из свинины
Секрет приготовления вкусного и рассыпчатого плова из свинины. Я буду готовить в казане, но вы мо...
```
Для этого вводим
```bash
python guard.py --using mgm-camellia --prolix -o tuda e message
```

Шифр:
```
66484984192513896831160448186742201462116397851240328517756004816312869191122609481810458517662159894736160676377630014344838583611741355276985620490420070464742575480045891881592032653016759505136550430608857278181005896512556539071558192209571147589868425869580355313703281605170433468792209831827403602692177940631921814856096375541373433743927196705936317228601388935640761080682419703821730280988960932778414916001107060845330893004400209928825564093380211402631147716034123943335319330205152862271659222688305186865761255915247430613209949985559969138729
```

В файле `tuda` будет содержаться вся информация о шифре:
```json
{
    "Mode": "e",
    "Algorithm": "mgm-camellia",
    "Return Type": "str",
    "Key": 48026,
    "Nonce": 127605887595351923798765477786913079296,
    "Tag": 81420972082389682930235389025279442756,
    "Remainder": 68,
    "Associated Data": 255120189682909226493113616069406382586,
    "Message": "\u041f\u043b\u043e\u0432 \u0438\u0437 \u0441\u0432\u0438\u043d\u0438\u043d\u044b\n\u0421\u0435\u043a\u0440\u0435\u0442 \u043f\u0440\u0438\u0433\u043e\u0442\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u043a\u0443\u0441\u043d\u043e\u0433\u043e \u0438 \u0440\u0430\u0441\u0441\u044b\u043f\u0447\u0430\u0442\u043e\u0433\u043e \u043f\u043b\u043e\u0432\u0430 \u0438\u0437 \u0441\u0432\u0438\u043d\u0438\u043d\u044b. \u042f \u0431\u0443\u0434\u0443 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c \u0432 \u043a\u0430\u0437\u0430\u043d\u0435, \u043d\u043e \u0432\u044b \u043c\u043e...\n",
    "Cipher": 66484984192513896831160448186742201462116397851240328517756004816312869191122609481810458517662159894736160676377630014344838583611741355276985620490420070464742575480045891881592032653016759505136550430608857278181005896512556539071558192209571147589868425869580355313703281605170433468792209831827403602692177940631921814856096375541373433743927196705936317228601388935640761080682419703821730280988960932778414916001107060845330893004400209928825564093380211402631147716034123943335319330205152862271659222688305186865761255915247430613209949985559969138729
}
```

Для расшифровки можно, например, использовать команду
```bash
python guard.py -u mgm-camellia -i tuda decrypt 66484984192513896831160448186742201462116397851240328517756004816312869191122609481810458517662159894736160676377630014344838583611741355276985620490420070464742575480045891881592032653016759505136550430608857278181005896512556539071558192209571147589868425869580355313703281605170433468792209831827403602692177940631921814856096375541373433743927196705936317228601388935640761080682419703821730280988960932778414916001107060845330893004400209928825564093380211402631147716034123943335319330205152862271659222688305186865761255915247430613209949985559969138729
```

## Тестирование
Всё достаточно просто:

для тестирования алгоритмов шифрования стоит ввести
```bash
python -m unittest unittests.test_ciphers -v
```

Аналогично для тестирования режимов шифрования надо написать
```bash
python -m unittest unittests.test_cipher_modes -v
```

